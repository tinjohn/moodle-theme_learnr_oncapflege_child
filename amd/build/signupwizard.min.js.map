{"version":3,"file":"signupwizard.min.js","sources":["../src/signupwizard.js"],"sourcesContent":["import {eventTypes as formEventTypes} from 'core_form/events';\n\nexport const init = () => {\n\n    /**\n     * Function to add list entries based on event messages\n     * @param {any} message\n     * @returns {any}\n     */\n    function addListEntry(message) {\n        const listItem = document.createElement('li');\n        listItem.textContent = message;\n        listItem.classList.add(\"nodecoration\");\n        errorSummaryUl.appendChild(listItem);\n    }\n    /**\n     * Function to remove all list entries based on event messages\n     * @returns {any}\n     */\n    function removeAllListEntries() {\n        const ul = document.querySelector('#formerrorssummary ul'); // Get a reference to the <ul> element\n        // Remove all <li> elements from the <ul>\n        while (ul.firstChild) {\n            ul.removeChild(ul.firstChild);\n        }\n    }\n\n    /**\n     * Description\n     * @param {any} e\n     * @returns {any}\n     */\n    function fieldValidationFailedListener(e) {\n        const message = e.detail.message;\n        if (message != \"\") {\n            addListEntry(message);\n            const errorSummary = document.querySelector('#formerrorssummary');\n            errorSummary.classList.remove('hidden');\n        }\n    }\n\n    /**\n     * Description\n     * @returns {any}\n     */\n    function refreshWizard() {\n        tabTargets[currentStep].classList.remove('active');\n        currentStep = 0;\n        for(var i=steps[currentStep]+1; i< tabPanels.length; i++) {\n            tabPanels[i].classList.add('hidden');\n        }\n        for(var i=0; i <= steps[currentStep]; i++) {\n            tabPanels[i].classList.remove('hidden');\n        }\n        tabTargets[currentStep].classList.add('active');\n        updateStatusDisplay();\n        refreshErrorsummary();\n    }\n\n    /**\n     * Description\n     * @returns {any}\n     */\n    function refreshErrorsummary () {\n        const errorSummary = document.querySelector('#formerrorssummary');\n        errorSummary.classList.add('hidden');\n        removeAllListEntries();\n    }\n\n    // Create the pagination div and its contents\n    const paginationHTML = `\n    <div class=\"pagination\">\n    <a class=\"btn hidden\" id=\"prev\"><i class=\"fa fa-chevron-circle-left\" aria-hidden=\"true\"></i></a>\n    <a class=\"btn \" id=\"next\"><i class=\"fa fa-chevron-circle-right\" aria-hidden=\"true\"></i>    </a>\n    <a class=\"btn hidden\" id=\"refresh\"><i class=\"fa fa-refresh\" aria-hidden=\"true\"></i></a>\n    </div>\n    `;\n\n    // Get a reference to the first form element in the document\n    const form = document.querySelector('form');\n    const signup = document.querySelector('div.signupform');\n    // Append the pagination HTML to the form\n    signup.insertAdjacentHTML('beforeend', paginationHTML);\n    const errorSummaryUl = document.querySelector('#formerrorssummary ul');\n\n    const submitButton = document.querySelector('input[type=\"submit\"]');\n    submitButton.addEventListener('click', () => {\n         // Remove the event listener\n        form.removeEventListener(formEventTypes.formFieldValidationFailed, fieldValidationFailedListener);\n        refreshErrorsummary();\n        form.addEventListener(formEventTypes.formFieldValidationFailed, fieldValidationFailedListener);\n    });\n\n\n    // Add the event listener\n//    form.addEventListener(formEventTypes.formFieldValidationFailed, fieldValidationFailedListener);\n\n    // form.addEventListener(formEventTypes.formFieldValidationFailed, e => {\n    //     const message = e.detail.message;\n    //     if(message != \"\") {\n    //         addListEntry(message);\n    //     }\n    //     const errorSummary = document.querySelector('#formerrorssummary');\n    //     errorSummary.classList.remove('hidden');\n    // });\n\n    const refreshButton = document.querySelector('#refresh');\n    const previousButton = document.querySelector('#prev');\n    const nextButton = document.querySelector('#next');\n    //const submitButton = document.querySelector('#submit');\n    const tabPanels1 = form.querySelectorAll('form > div.form-group');\n    const tabPanels2 = form.querySelectorAll('form > fieldset');\n    const tabPanels = Array.from(tabPanels1).concat(Array.from(tabPanels2));\n\n    const isEmpty = (str) => !str.trim().length;\n    let currentStep = 0;\n    const steps = [4, 8, 10, 11, tabPanels.length - 1];\n\n    // Create the tab status HTML\n    var tabStatusHTML = `\n    <div class=\"tab-status\">\n        <span class=\"tab active\">1</span>\n    `;\n    for(var sc = 2; sc < steps.length; sc++) {\n    tabStatusHTML += `\n        <span class=\"tab\">` + sc + `</span>\n    `;\n    }\n    // Create the tab status HTML\n    tabStatusHTML += `\n    <span class=\"helppix\"></span>\n    </div>\n    `;\n    // Append the pagination HTML to the form\n    signup.insertAdjacentHTML('beforebegin', tabStatusHTML);\n\n    const tabTargets = document.querySelectorAll('.tab');\n\n    // currentStep is 0\n    for(var i=steps[currentStep]+1; i< tabPanels.length; i++) {\n        tabPanels[i].classList.add('hidden');\n    }\n\n    // Next: Change UI relative to the current step and account for button permissions\n    nextButton.addEventListener('click', (event) => {\n        // Prevent default on links\n        event.preventDefault();\n        // Hide current tab\n        for(var i = 0 ; i <= steps[currentStep]; i++) {\n            tabPanels[i].classList.add('hidden');\n        }\n        tabTargets[currentStep].classList.remove('active');\n        // Show next tab\n        for(i=steps[currentStep]+1; i <= steps[currentStep + 1]; i++) {\n            tabPanels[i].classList.remove('hidden');\n        }\n        currentStep += 1;\n        tabTargets[currentStep].classList.add('active');\n        //validateEntry();\n        updateStatusDisplay();\n    });\n\n    // Previous: Change UI relative to current step and account for button permissions\n    previousButton.addEventListener('click', (event) => {\n        event.preventDefault();\n        // Hide current tab\n        for(var i = 0; i < tabPanels.length; i++) {\n            tabPanels[i].classList.add('hidden');\n        }\n        tabTargets[currentStep].classList.remove('active');\n        // Show previous tab\n        if (currentStep < 2) {\n            var start = -1;\n        }  else {\n            var start = steps[currentStep - 2];\n        }\n        for(i = start + 1; i <= steps[currentStep -1]; i++) {\n            tabPanels[i].classList.remove('hidden');\n        }\n        tabTargets[currentStep - 1].classList.add('active');\n        currentStep -= 1;\n        nextButton.removeAttribute('disabled');\n        updateStatusDisplay();\n    });\n\n    // Refresh: Change UI relative to current step and account for button permissions\n    refreshButton.addEventListener('click', () => {\n        refreshWizard();\n    });\n\n\n\n    /**\n     * updateStatusDisplay\n     * @returns {any}\n     */\n    function updateStatusDisplay() {\n        // If on the last step, hide the next button and show submit\n        if (currentStep === tabTargets.length - 1) {\n            nextButton.classList.add('hidden');\n            previousButton.classList.remove('hidden');\n            refreshButton.classList.remove('hidden');\n            //submitButton.classList.remove('hidden');\n            validateEntry();\n            // If it's the first step hide the previous button\n        } else if (currentStep == 0) {\n            nextButton.classList.remove('hidden');\n            previousButton.classList.add('hidden');\n            refreshButton.classList.add('hidden');\n            //submitButton.classList.add('hidden');\n            // In all other instances display both buttons\n        } else {\n            nextButton.classList.remove('hidden');\n            previousButton.classList.remove('hidden');\n            refreshButton.classList.add('hidden');\n            //submitButton.classList.add('hidden');\n        }\n    }\n\n\n    /**\n     * Description\n     * @returns {any}\n     */\n    function validateEntry() {\n        let input = tabPanels[currentStep].querySelector('input');\n        // Start but disabling continue button\n        nextButton.setAttribute('disabled', true);\n        //submitButton.setAttribute('disabled', true);\n        // Validate on initial function fire\n        setButtonPermissions(input);\n        // Validate on input\n        input.addEventListener('input', () => setButtonPermissions(input));\n        // Validate if bluring from input\n        input.addEventListener('blur', () => setButtonPermissions(input));\n    }\n\n    /**\n     * Description\n     * @param {any} input\n     * @returns {any}\n     */\n    function setButtonPermissions(input) {\n        if (isEmpty(input.value)) {\n            nextButton.setAttribute('disabled', true);\n            //submitButton.setAttribute('disabled', true);\n        } else {\n            nextButton.removeAttribute('disabled');\n            //submitButton.removeAttribute('disabled');\n        }\n    }\n};"],"names":["fieldValidationFailedListener","e","message","detail","listItem","document","createElement","textContent","classList","add","errorSummaryUl","appendChild","addListEntry","querySelector","remove","refreshErrorsummary","ul","firstChild","removeChild","removeAllListEntries","form","signup","insertAdjacentHTML","addEventListener","removeEventListener","formEventTypes","formFieldValidationFailed","refreshButton","previousButton","nextButton","tabPanels1","querySelectorAll","tabPanels2","tabPanels","Array","from","concat","currentStep","steps","length","tabStatusHTML","sc","tabTargets","i","updateStatusDisplay","input","setAttribute","setButtonPermissions","validateEntry","value","trim","removeAttribute","event","preventDefault","start","refreshWizard"],"mappings":"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"}